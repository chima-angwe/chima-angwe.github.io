import{r as m,j as e,m as C,e as S,h as P,H as v,l as E,I as k,J as F}from"./index-Ctl3OINq.js";import{u as B,E as T}from"./ErrorMessage-DHev1uHZ.js";import{u as z,c as A,d as M,g as R}from"./blogService-DOWoi9Q5.js";import{B as j}from"./Button-PIolUsCM.js";import{u as U,I as y}from"./Input-CgTt5tG4.js";import{u as _}from"./uploadService-CPDpqT1g.js";import{T as w}from"./Textarea-Ub0A6M40.js";import{B as q}from"./constants-DAdbbRzX.js";import{A as D}from"./index-Cmy4rXYY.js";import{f as V}from"./formatDate-ClDaI8Qs.js";const G=({post:l,onClose:r})=>{const[u,o]=m.useState(!1),[x,g]=m.useState(!1),[h,n]=m.useState(""),{register:s,handleSubmit:p,formState:{errors:c},setValue:b,watch:f}=U({defaultValues:l||{title:"",excerpt:"",content:"",featuredImage:"",category:"Tech",tags:[],published:!0}}),a=f("featuredImage");m.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]);const N=async t=>{const i=t.target.files[0];if(i)try{g(!0);const d=await _(i);b("featuredImage",d.url)}catch{alert("Failed to upload image")}finally{g(!1)}},I=async t=>{try{o(!0),n("");const i={...t,tags:t.tags.split(",").map(d=>d.trim()).filter(d=>d)};l?await z(l._id,i):await A(i),r()}catch(i){n(i.response?.data?.message||"Failed to save post")}finally{o(!1)}};return e.jsx(D,{children:e.jsx("div",{className:"modal-overlay",onClick:r,children:e.jsxs(C.div,{className:"blog-form-modal",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:l?"Edit Blog Post":"Create New Post"}),e.jsx("button",{onClick:r,className:"modal-close-btn",children:e.jsx(S,{size:20})})]}),e.jsxs("form",{onSubmit:p(I),className:"blog-form",children:[e.jsx(y,{label:"Title",name:"title",placeholder:"Getting Started with React Hooks",register:s,error:c.title,required:!0}),e.jsx(w,{label:"Excerpt",name:"excerpt",placeholder:"Short summary of your post...",rows:2,register:s,error:c.excerpt,required:!0}),e.jsx(w,{label:"Content",name:"content",placeholder:"Write your blog post content here...",rows:8,register:s,error:c.content,required:!0}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Featured Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:N,disabled:x}),x&&e.jsx("p",{children:"Uploading..."}),a&&e.jsx("img",{src:a,alt:"Preview",className:"image-preview"})]}),e.jsx(y,{label:"Featured Image URL (or upload above)",name:"featuredImage",placeholder:"https://...",register:s,error:c.featuredImage,required:!0}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsx("select",{...s("category"),className:"form-select",children:q.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsx(y,{label:"Tags (comma-separated)",name:"tags",placeholder:"React, JavaScript, Tutorial",register:s}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",...s("published")}),e.jsx("span",{children:"Publish immediately"})]})}),h&&e.jsx("p",{className:"error-text",children:h}),e.jsxs("div",{className:"form-actions",children:[e.jsx(j,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),e.jsx(j,{type:"submit",variant:"primary",disabled:u,children:u?"Saving...":l?"Update":"Create"})]})]})]})})})},Z=()=>{const[l,r]=m.useState(!1),[u,o]=m.useState(null),{data:x,loading:g,error:h,refetch:n}=B(()=>R(1,1e3)),s=x?.posts||[],p=()=>{o(null),r(!0)},c=a=>{o(a),r(!0)},b=async a=>{if(window.confirm("Are you sure you want to delete this blog post?"))try{await M(a),n()}catch{alert("Failed to delete blog post")}},f=()=>{r(!1),o(null),n()};return g?e.jsx(P,{fullScreen:!0,size:"large"}):h?e.jsx(T,{message:h,onRetry:n}):e.jsxs("div",{className:"manage-blog-page",children:[e.jsxs("div",{className:"manage-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"manage-title",children:"Manage Blog Posts"}),e.jsx("p",{className:"manage-subtitle",children:"Create, edit, and delete your blog posts"})]}),e.jsxs(j,{variant:"primary",onClick:p,children:[e.jsx(v,{size:16,className:"mr-2"}),"New Post"]})]}),s.length>0?e.jsx("div",{className:"blog-table-wrapper",children:e.jsxs("table",{className:"blog-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Published"}),e.jsx("th",{children:"Views"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:s.map(a=>e.jsxs(C.tr,{initial:{opacity:0},animate:{opacity:1},children:[e.jsx("td",{children:e.jsx("img",{src:a.featuredImage,alt:a.title,className:"post-thumbnail"})}),e.jsx("td",{className:"post-title-cell",children:a.title}),e.jsx("td",{children:e.jsx("span",{className:"post-category",children:a.category})}),e.jsx("td",{children:a.published?e.jsx("span",{className:"badge-success",children:"Yes"}):e.jsx("span",{className:"badge-default",children:"No"})}),e.jsx("td",{children:a.views}),e.jsx("td",{children:V(a.createdAt)}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:()=>window.open(`/blog/${a.slug}`,"_blank"),className:"action-btn view-btn",title:"View",children:e.jsx(E,{size:16})}),e.jsx("button",{onClick:()=>c(a),className:"action-btn edit-btn",title:"Edit",children:e.jsx(k,{size:16})}),e.jsx("button",{onClick:()=>b(a._id),className:"action-btn delete-btn",title:"Delete",children:e.jsx(F,{size:16})})]})})]},a._id))})]})}):e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"No blog posts yet. Create your first post!"}),e.jsxs(j,{variant:"primary",onClick:p,children:[e.jsx(v,{size:16,className:"mr-2"}),"Create Post"]})]}),l&&e.jsx(G,{post:u,onClose:f})]})};export{Z as default};
