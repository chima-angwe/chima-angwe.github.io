import{r as h,j as e,h as x,m as r,M as g,t as d,J as u}from"./index-Ctl3OINq.js";import{u as p,E as N}from"./ErrorMessage-DHev1uHZ.js";import{m as v,d as f,g as y}from"./contactService-DlIepd6S.js";import{f as n}from"./formatDate-ClDaI8Qs.js";const F=()=>{const[a,t]=h.useState(null),{data:i,loading:m,error:c,refetch:l}=p(y),o=async s=>{try{await v(s),l()}catch{alert("Failed to mark as read")}},j=async s=>{if(window.confirm("Are you sure you want to delete this message?"))try{await f(s),a?._id===s&&t(null),l()}catch{alert("Failed to delete message")}};return m?e.jsx(x,{fullScreen:!0,size:"large"}):c?e.jsx(N,{message:c,onRetry:l}):e.jsxs("div",{className:"view-messages-page",children:[e.jsxs("div",{className:"messages-header",children:[e.jsx("h1",{className:"messages-title",children:"Contact Messages"}),e.jsxs("p",{className:"messages-subtitle",children:[i?.filter(s=>!s.read).length||0," unread messages"]})]}),e.jsxs("div",{className:"messages-layout",children:[e.jsx("div",{className:"messages-list",children:i&&i.length>0?i.map(s=>e.jsxs(r.div,{className:`message-item ${s.read?"":"unread"} ${a?._id===s._id?"active":""}`,onClick:()=>{t(s),s.read||o(s._id)},initial:{opacity:0},animate:{opacity:1},children:[e.jsx("div",{className:"message-icon",children:s.read?e.jsx(g,{size:20}):e.jsx(d,{size:20})}),e.jsxs("div",{className:"message-preview",children:[e.jsxs("div",{className:"message-from",children:[e.jsx("strong",{children:s.name}),!s.read&&e.jsx("span",{className:"unread-badge",children:"New"})]}),e.jsx("p",{className:"message-subject",children:s.subject||"No subject"}),e.jsx("p",{className:"message-date",children:n(s.createdAt)})]})]},s._id)):e.jsx("div",{className:"empty-messages",children:e.jsx("p",{children:"No messages yet"})})}),e.jsx("div",{className:"message-detail",children:a?e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},className:"message-content",children:[e.jsxs("div",{className:"message-detail-header",children:[e.jsxs("div",{children:[e.jsx("h2",{children:a.name}),e.jsx("p",{className:"message-email",children:a.email}),e.jsx("p",{className:"message-date-detail",children:n(a.createdAt)})]}),e.jsxs("button",{onClick:()=>j(a._id),className:"delete-btn-large",children:[e.jsx(u,{size:16}),"Delete"]})]}),a.subject&&e.jsxs("div",{className:"message-subject-box",children:[e.jsx("strong",{children:"Subject:"})," ",a.subject]}),e.jsxs("div",{className:"message-body",children:[e.jsx("strong",{children:"Message:"}),e.jsx("p",{children:a.message})]}),e.jsx("div",{className:"message-actions",children:e.jsx("a",{href:`mailto:${a.email}?subject=Re: ${a.subject||"Your message"}`,className:"reply-btn",children:"Reply via Email"})})]}):e.jsxs("div",{className:"no-message-selected",children:[e.jsx(d,{size:48}),e.jsx("p",{children:"Select a message to view"})]})})]})]})};export{F as default};
