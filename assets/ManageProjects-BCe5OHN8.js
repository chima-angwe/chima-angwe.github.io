import{r as u,j as e,m as S,e as w,h as C,H as v,l as P,I as E,J as F}from"./index-Ctl3OINq.js";import{u as T,E as U}from"./ErrorMessage-DHev1uHZ.js";import{u as D,c as I,d as A,g as M}from"./projectService-3Noc3JKV.js";import{B as f}from"./Button-PIolUsCM.js";import{u as R,I as h}from"./Input-CgTt5tG4.js";import{u as z}from"./uploadService-CPDpqT1g.js";import{T as q}from"./Textarea-Ub0A6M40.js";import{P as L}from"./constants-DAdbbRzX.js";import{A as _}from"./index-Cmy4rXYY.js";import{f as B}from"./formatDate-ClDaI8Qs.js";const V=({project:l,onClose:r})=>{const[x,n]=u.useState(!1),[o,b]=u.useState(!1),[j,d]=u.useState(""),{register:a,handleSubmit:g,formState:{errors:i},setValue:y,watch:t}=R({defaultValues:l||{title:"",description:"",fullDescription:"",thumbnail:"",techStack:[],category:"Web App",liveUrl:"",githubUrl:"",featured:!1}}),p=t("thumbnail");u.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]);const N=async s=>{const c=s.target.files[0];if(c)try{b(!0);const m=await z(c);y("thumbnail",m.url)}catch{alert("Failed to upload image")}finally{b(!1)}},k=async s=>{try{n(!0),d("");const c={...s,techStack:s.techStack.split(",").map(m=>m.trim()).filter(m=>m)};l?await D(l._id,c):await I(c),r()}catch(c){d(c.response?.data?.message||"Failed to save project")}finally{n(!1)}};return e.jsx(_,{children:e.jsx("div",{className:"modal-overlay",onClick:r,children:e.jsxs(S.div,{className:"project-form-modal",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:l?"Edit Project":"Create New Project"}),e.jsx("button",{onClick:r,className:"modal-close-btn",children:e.jsx(w,{size:20})})]}),e.jsxs("form",{onSubmit:g(k),className:"project-form",children:[e.jsx(h,{label:"Title",name:"title",placeholder:"E-Commerce Platform",register:a,error:i.title,required:!0}),e.jsx(h,{label:"Short Description",name:"description",placeholder:"Full-stack online shopping platform",register:a,error:i.description,required:!0}),e.jsx(q,{label:"Full Description",name:"fullDescription",placeholder:"Detailed description of your project...",rows:4,register:a,error:i.fullDescription,required:!0}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Thumbnail Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:N,disabled:o}),o&&e.jsx("p",{children:"Uploading..."}),p&&e.jsx("img",{src:p,alt:"Preview",className:"image-preview"})]}),e.jsx(h,{label:"Thumbnail URL (or upload above)",name:"thumbnail",placeholder:"https://...",register:a,error:i.thumbnail,required:!0}),e.jsx(h,{label:"Tech Stack (comma-separated)",name:"techStack",placeholder:"React, Node.js, MongoDB, Stripe",register:a,error:i.techStack,required:!0}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsx("select",{...a("category"),className:"form-select",children:L.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx(h,{label:"Live URL",name:"liveUrl",placeholder:"https://...",register:a}),e.jsx(h,{label:"GitHub URL",name:"githubUrl",placeholder:"https://github.com/...",register:a}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",...a("featured")}),e.jsx("span",{children:"Featured Project"})]})}),j&&e.jsx("p",{className:"error-text",children:j}),e.jsxs("div",{className:"form-actions",children:[e.jsx(f,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),e.jsx(f,{type:"submit",variant:"primary",disabled:x,children:x?"Saving...":l?"Update":"Create"})]})]})]})})})},$=()=>{const[l,r]=u.useState(!1),[x,n]=u.useState(null),{data:o,loading:b,error:j,refetch:d}=T(M),a=()=>{n(null),r(!0)},g=t=>{n(t),r(!0)},i=async t=>{if(window.confirm("Are you sure you want to delete this project?"))try{await A(t),d()}catch{alert("Failed to delete project")}},y=()=>{r(!1),n(null),d()};return b?e.jsx(C,{fullScreen:!0,size:"large"}):j?e.jsx(U,{message:j,onRetry:d}):e.jsxs("div",{className:"manage-projects-page",children:[e.jsxs("div",{className:"manage-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"manage-title",children:"Manage Projects"}),e.jsx("p",{className:"manage-subtitle",children:"Create, edit, and delete your portfolio projects"})]}),e.jsxs(f,{variant:"primary",onClick:a,children:[e.jsx(v,{size:16,className:"mr-2"}),"New Project"]})]}),o&&o.length>0?e.jsx("div",{className:"projects-table-wrapper",children:e.jsxs("table",{className:"projects-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Thumbnail"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Tech Stack"}),e.jsx("th",{children:"Featured"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:o.map(t=>e.jsxs(S.tr,{initial:{opacity:0},animate:{opacity:1},children:[e.jsx("td",{children:e.jsx("img",{src:t.thumbnail,alt:t.title,className:"project-thumbnail"})}),e.jsx("td",{className:"project-title-cell",children:t.title}),e.jsx("td",{children:e.jsx("span",{className:"project-category",children:t.category})}),e.jsx("td",{children:e.jsxs("div",{className:"tech-stack-cell",children:[t.techStack.slice(0,2).map((p,N)=>e.jsx("span",{className:"tech-badge",children:p},N)),t.techStack.length>2&&e.jsxs("span",{className:"tech-badge",children:["+",t.techStack.length-2]})]})}),e.jsx("td",{children:t.featured?e.jsx("span",{className:"badge-success",children:"Yes"}):e.jsx("span",{className:"badge-default",children:"No"})}),e.jsx("td",{children:B(t.createdAt)}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:()=>window.open("/projects","_blank"),className:"action-btn view-btn",title:"View",children:e.jsx(P,{size:16})}),e.jsx("button",{onClick:()=>g(t),className:"action-btn edit-btn",title:"Edit",children:e.jsx(E,{size:16})}),e.jsx("button",{onClick:()=>i(t._id),className:"action-btn delete-btn",title:"Delete",children:e.jsx(F,{size:16})})]})})]},t._id))})]})}):e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"No projects yet. Create your first project!"}),e.jsxs(f,{variant:"primary",onClick:a,children:[e.jsx(v,{size:16,className:"mr-2"}),"Create Project"]})]}),l&&e.jsx(V,{project:x,onClose:y})]})};export{$ as default};
